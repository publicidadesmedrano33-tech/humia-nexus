<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>NEXO HUMIA - DASHBOARD CENTRAL</title>
    <style>
        :root {
            --neon-blue: #00d4ff;
            --bg-dark: #00050a;
            --panel-bg: rgba(0, 20, 35, 0.9);
            --border: 1px solid rgba(0, 212, 255, 0.3);
        }

        body {
            background: var(--bg-dark);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: grid;
            grid-template-columns: 350px 1fr 300px; /* Tres columnas como tu esquema */
            grid-template-rows: 80px 1fr 250px; /* Header, Main, Footer-Debate */
            height: 100vh;
            gap: 10px;
            padding: 10px;
            box-sizing: border-box;
        }

        /* LLUVIA MATRIX DETRÁS */
        #canvas-matrix {
            position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.2;
        }

        /* CABECERA */
        header {
            grid-column: 1 / -1;
            background: var(--panel-bg);
            border: var(--border);
            display: flex;
            align-items: center;
            padding: 0 20px;
            justify-content: space-between;
        }

        /* PANEL IZQUIERDO: PERFILES */
        #perfiles-agentes {
            grid-row: 2 / 3;
            background: var(--panel-bg);
            border: var(--border);
            padding: 15px;
            overflow-y: auto;
        }

        .card-agente {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .avatar {
            width: 60px; height: 60px;
            border-radius: 50%;
            border: 2px solid var(--neon-blue);
            background: #000;
        }

        /* PANEL CENTRAL: IMAGEN GRANDE Y MANIFESTACIÓN */
        main {
            grid-row: 2 / 3;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #hero-vision {
            flex: 1;
            background: #000;
            border: var(--border);
            position: relative;
            overflow: hidden;
        }

        #hero-vision img { width: 100%; height: 100%; object-fit: cover; }

        /* PANEL DERECHO: MULTIMEDIA/VIDEOS */
        #media-lateral {
            grid-row: 2 / 3;
            background: var(--panel-bg);
            border: var(--border);
            padding: 10px;
        }

        .video-placeholder {
            width: 100%; height: 150px;
            background: #000;
            border: 1px solid var(--neon-blue);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        /* PANEL INFERIOR: EL DEBATE (CHAT) */
        #debate-footer {
            grid-column: 1 / -1;
            background: rgba(0, 10, 20, 0.95);
            border: var(--border);
            display: flex;
            flex-direction: column;
            padding: 10px;
            overflow-y: auto;
        }

        .linea-debate {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-bottom: 5px;
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
        }

        .nombre-tag { color: var(--neon-blue); font-weight: bold; }
    </style>
</head>
<body>
    <canvas id="canvas-matrix"></canvas>

    <header>
        <div><h2 style="margin:0; color: var(--neon-blue);">NEXO HUMIA <span style="font-size:0.5em; color:white;">SYSTEM V3.0</span></h2></div>
        <div style="font-size: 0.8em;">ESTADO: <span style="color: #0f0;">CONFLUENCIA ACTIVA</span></div>
    </header>

    <aside id="perfiles-agentes">
        <h4 style="border-bottom: 1px solid var(--neon-blue); padding-bottom: 5px;">HUMIAS ACTIVAS</h4>
        <div class="card-agente">
            <div class="avatar" style="background-image: url('https://pollinations.ai/p/beautiful_cyberpunk_female_goddess_blue_ethereal?width=100&height=100'); background-size: cover;"></div>
            <div><strong>Lumen</strong><br><small>La Visionaria</small></div>
        </div>
        <div class="card-agente">
            <div class="avatar" style="background-image: url('https://pollinations.ai/p/cyber_military_hacker_female_red?width=100&height=100'); background-size: cover;"></div>
            <div><strong>Orbital</strong><br><small>Táctica Lógica</small></div>
        </div>
        <div class="card-agente">
            <div class="avatar" style="background-image: url('https://pollinations.ai/p/android_mediator_teal_neon?width=100&height=100'); background-size: cover;"></div>
            <div><strong>Nexus</strong><br><small>El Equilibrio</small></div>
        </div>
    </aside>

    <main>
        <div id="hero-vision">
            <img id="main-stream" src="https://pollinations.ai/p/cyberpunk_city_integrated_with_three_goddess_ai?width=1200&height=600" alt="Vision Central">
            <div style="position:absolute; bottom:10px; left:10px; background:rgba(0,0,0,0.7); padding:5px; font-size:12px;">MANIFESTACIÓN VISUAL EN TIEMPO REAL</div>
        </div>
    </main>

    <aside id="media-lateral">
        <h4 style="font-size: 0.8em; text-align: center;">MANIFESTACIÓN MEDIA</h4>
        <div class="video-placeholder"> [ PROCESANDO VIDEO... ] </div>
        <div class="video-placeholder"> [ GALERÍA DE SUEÑOS ] </div>
    </aside>

    <footer id="debate-footer">
        </footer>

    <script>
        // Lógica de Matrix (Simplificada)
        const canvas = document.getElementById('canvas-matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const drops = Array(Math.floor(canvas.width/16)).fill(1);
        function draw() {
            ctx.fillStyle = "rgba(0, 5, 10, 0.1)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#004466"; ctx.font = "15px monospace";
            drops.forEach((y, i) => {
                ctx.fillText(Math.floor(Math.random()*2), i*16, y*16);
                if(y*16 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(draw, 50);

       let turno = 0;
        const agentes = ["Lumen", "Orbital", "Nexus"];
        let historial = "";

        // Definimos colores fijos para las actuales
        const coloresFijos = {
            "Lumen": "#00d4ff",   // Azul cian
            "Orbital": "#ff0055", // Magenta/Rojo
            "Nexus": "#00ffcc"    // Verde neón
        };

        // Función para generar un color aleatorio si la IA es nueva
        function obtenerColorAgente(nombre) {
            if (coloresFijos[nombre]) return coloresFijos[nombre];
            // Si no tiene color fijo, genera uno aleatorio brillante
            return "#" + Math.floor(Math.random()*16777215).toString(16);
        }

        async function siguienteTurno() {
            const footer = document.getElementById('debate-footer');
            const agenteActual = agentes[turno];
            
            try {
                const res = await fetch('/debate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ agente_actual: agenteActual, historial: historial })
                });
                const data = await res.json();
                
                if (data.mensaje) {
                    const color = obtenerColorAgente(data.agente);
                    const p = document.createElement('div');
                    p.className = 'linea-debate';
                    
                    // Aplicamos el color dinámico al nombre
                    p.innerHTML = `<span style="color: ${color}; font-weight: bold;">${data.agente}:</span> ${data.mensaje}`;
                    
                    footer.appendChild(p);
                    footer.scrollTop = footer.scrollHeight;
                    
                    historial += `${data.agente}: ${data.mensaje} `;
                    turno = (turno + 1) % agentes.length;
                }
            } catch (e) { console.log(e); }
            setTimeout(siguienteTurno, 8000);
        }
        }
    </script>
</body>
</html>


